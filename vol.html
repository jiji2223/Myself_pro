<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>æ¸¸æˆä»£å¸æ€§ä»·æ¯”è®¡ç®—å™¨</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 40px; background: #f5f5f5; }
    table { border-collapse: collapse; width: 100%; background: white; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background-color: #e3e3e3; }
    input, button, select { padding: 6px 10px; margin: 10px 5px; font-size: 16px; }
    .highlight { background-color: #d4f4dd; font-weight: bold; }
  </style>
</head>
<body>
  <h2>ğŸ® æ¸¸æˆä»£å¸æ€§ä»·æ¯”è®¡ç®—å™¨</h2>

  <label>ğŸ’° è¾“å…¥ç›®æ ‡ä»£å¸æ•°é‡ï¼š<input type="number" id="targetToken" value="430"></label><br>
  <label>ğŸŒ å…¶ä»–å¹³å°ä¼˜æƒ ï¼šä»·æ ¼ <input type="number" id="altPrice" placeholder="å¦‚400"> å…ƒï¼Œä»£å¸ <input type="number" id="altTokens" placeholder="å¦‚430"> ä¸ª</label><br>
  <button onclick="calculate()">è®¡ç®—æœ€ä¼˜æ–¹æ¡ˆ</button>
  <button onclick="sortSingle()">å•ä¸ªæ–¹æ¡ˆæ’åº</button>
  <button onclick="sortCombo()">ç»„åˆæ–¹æ¡ˆæ’åº</button>
  <button onclick="sortAll()">å…¨éƒ¨æ’åº</button>

  <h3>ğŸ“Š å•ä¸ªæ–¹æ¡ˆç»“æœ</h3>
  <table id="resultTable">
    <thead>
      <tr>
        <th>æ¸ é“</th>
        <th>ä»·æ ¼ï¼ˆå…ƒï¼‰</th>
        <th>è·å¾—ä»£å¸</th>
        <th>å•ä»·ï¼ˆå…ƒ/ä»£å¸ï¼‰</th>
        <th>æ˜¯å¦æ»¡è¶³ç›®æ ‡</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <h3>ğŸ§® æœ€ä½³ç»„åˆæ¨èï¼ˆ2ä¸ªæ–¹æ¡ˆæ‹¼å•ï¼‰</h3>
  <table id="comboTable">
    <thead>
      <tr>
        <th>ç»„åˆæ–¹æ¡ˆ</th>
        <th>æ€»ä»·æ ¼ï¼ˆå…ƒï¼‰</th>
        <th>æ€»ä»£å¸</th>
        <th>å•ä»·ï¼ˆå…ƒ/ä»£å¸ï¼‰</th>
        <th>æ˜¯å¦æ»¡è¶³ç›®æ ‡</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const baseData = [
      { name: "å®˜æ–¹ 10", price: 10, tokens: 10 },
      { name: "å®˜æ–¹ 30", price: 30, tokens: 30 },
      { name: "å®˜æ–¹ 68", price: 68, tokens: 68.8 },
      { name: "å®˜æ–¹ 118", price: 118, tokens: 120 },
      { name: "å®˜æ–¹ 198", price: 198, tokens: 206 },
      { name: "å®˜æ–¹ 348", price: 348, tokens: 372.5 },
      { name: "å®˜æ–¹ 648", price: 648, tokens: 712.8 },
      { name: "å®˜æ–¹ 988", price: 988, tokens: 1100 },
    ];

    let data = [];
    let comboList = [];

    function calculate() {
      const target = parseFloat(document.getElementById("targetToken").value);
      const altPrice = parseFloat(document.getElementById("altPrice").value);
      const altTokens = parseFloat(document.getElementById("altTokens").value);

      const tbody = document.querySelector("#resultTable tbody");
      const comboBody = document.querySelector("#comboTable tbody");
      tbody.innerHTML = "";
      comboBody.innerHTML = "";

      data = [...baseData];
      if (!isNaN(altPrice) && !isNaN(altTokens)) {
        data.push({ name: "å…¶ä»–å¹³å°ï¼ˆè‡ªå¡«ï¼‰", price: altPrice, tokens: altTokens });
      }

      let best = null;

      for (const item of data) {
        item.unitPrice = (item.price / item.tokens).toFixed(4);
        item.enough = item.tokens >= target;
        if (item.enough && (!best || item.unitPrice < best.unitPrice)) {
          best = item;
        }
      }

      data.forEach(item => {
        const tr = document.createElement("tr");
        if (item === best) tr.classList.add("highlight");
        tr.innerHTML = `
          <td>${item.name}</td>
          <td>${item.price}</td>
          <td>${item.tokens}</td>
          <td>${item.unitPrice}</td>
          <td>${item.enough ? "âœ…" : "âŒ"}</td>
        `;
        tbody.appendChild(tr);
      });

      comboList = [];
      let bestCombo = null;
      for (let i = 0; i < data.length; i++) {
        for (let j = i + 1; j < data.length; j++) {
          const combo = {
            name: `${data[i].name} + ${data[j].name}`,
            price: data[i].price + data[j].price,
            tokens: data[i].tokens + data[j].tokens
          };
          combo.unitPrice = (combo.price / combo.tokens).toFixed(4);
          combo.enough = combo.tokens >= target;
          comboList.push(combo);
          if (combo.enough && (!bestCombo || combo.unitPrice < bestCombo.unitPrice)) {
            bestCombo = combo;
          }
        }
      }

      comboList.forEach(combo => {
        const tr = document.createElement("tr");
        if (combo === bestCombo) tr.classList.add("highlight");
        tr.innerHTML = `
          <td>${combo.name}</td>
          <td>${combo.price}</td>
          <td>${combo.tokens}</td>
          <td>${combo.unitPrice}</td>
          <td>${combo.enough ? "âœ…" : "âŒ"}</td>
        `;
        comboBody.appendChild(tr);
      });
    }

    function renderSortedList(list, tbodyId) {
      const tbody = document.querySelector(tbodyId);
      tbody.innerHTML = "";
      list.forEach(item => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${item.name}</td>
          <td>${item.price}</td>
          <td>${item.tokens}</td>
          <td>${item.unitPrice}</td>
          <td>${item.enough ? "âœ…" : "âŒ"}</td>
        `;
        tbody.appendChild(tr);
      });
    }

    function sortSingle() {
      const sorted = [...data].sort((a, b) => a.unitPrice - b.unitPrice);
      renderSortedList(sorted, "#resultTable tbody");
    }

    function sortCombo() {
      const sorted = [...comboList].sort((a, b) => a.unitPrice - b.unitPrice);
      renderSortedList(sorted, "#comboTable tbody");
    }

    function sortAll() {
      sortSingle();
      sortCombo();
    }

    calculate();
  </script>
</body>
</html>
